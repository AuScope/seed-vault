

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>seed_vault.service package &mdash; Seed Vault 0.1.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=92734c54"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Seed Vault
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../usage.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage.html#installation">Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../usage.html#install-via-pip-easy-way">Install via pip (easy way)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../usage.html#install-from-source-if-you-insist">Install from source (if you insist!)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../usage.html#step-1-clone-repository">Step 1: Clone repository</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../usage.html#step-2-setup-and-run">Step 2: Setup and run</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../usage.html#starting-the-application">Starting the Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage.html#getting-to-the-opening-page">Getting to the Opening Page</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage.html#i-event-based-workflow">i. Event Based Workflow</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../usage.html#step-1-search-select-events-page">“Step 1: Search &amp; Select Events” Page</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../usage.html#step-2-search-select-stations-page">“Step 2: Search &amp; Select Stations” Page</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../usage.html#step-3-waveforms-page">“Step 3: Waveforms” Page</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../usage.html#ii-station-based">ii. Station Based</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../usage.html#step-1-search-select-stations-page">“Step 1: Search &amp; Select Stations” Page</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../usage.html#step-2-search-select-events-page">“Step 2: Search &amp; Select Events” Page</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../usage.html#id1">“Step 3: Waveforms” Page</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../usage.html#iii-continuous-downloads">iii. Continuous Downloads</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../usage.html#id2">“Step 1: Search &amp; Select Stations” Page</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../usage.html#step-2-get-waveforms-page">“Step 2: Get Waveforms” Page</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../app.html">Seed Vault App</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../app_main_flows.html">Main Flows</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../workflow_comparison.html">Workflow Comparison</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../workflow_comparison.html#choosing-the-right-workflow">Choosing the Right Workflow</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../flows/events_based.html">Events Based</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../flows/events_based.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../flows/events_based.html#workflow-steps">Workflow Steps</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../flows/events_based.html#step-1-search-select-events">Step 1: Search &amp; Select Events</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../flows/events_based.html#step-2-select-stations">Step 2: Select Stations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../flows/events_based.html#step-3-download-analyze-waveforms">Step 3: Download &amp; Analyze Waveforms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../flows/events_based.html#key-features">Key Features</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../flows/station_based.html">Station Based</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../flows/station_based.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../flows/station_based.html#workflow-steps">Workflow Steps</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../flows/station_based.html#step-1-search-select-stations">Step 1: Search &amp; Select Stations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../flows/station_based.html#step-2-select-events">Step 2: Select Events</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../flows/station_based.html#step-3-download-analyze-waveforms">Step 3: Download &amp; Analyze Waveforms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../flows/station_based.html#key-features">Key Features</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../flows/continuous_based.html">Continuous Based</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../flows/continuous_based.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../flows/continuous_based.html#workflow-steps">Workflow Steps</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../flows/continuous_based.html#step-1-search-select-stations">Step 1: Search &amp; Select Stations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../flows/continuous_based.html#step-2-download-continuous-data">Step 2: Download Continuous Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../flows/continuous_based.html#key-features">Key Features</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../app_main_flows.html#workflow-components">Workflow Components</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../app_run_from_config.html">Run from Parameters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../flows/run_from_parameters.html">Direct parameter input</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../flows/run_from_parameters.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../flows/run_from_parameters.html#references-and-documentation">References and Documentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../flows/run_from_parameters.html#workflow-steps">Workflow Steps</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../flows/run_from_parameters.html#step-1-load-and-execute-configuration">Step 1: Load and Execute Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../flows/run_from_parameters.html#key-features">Key Features</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../flows/run_from_parameters.html#parameter-reference">Parameter Reference</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../app_db_explorer.html">Database Explorer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../app_db_explorer.html#execute-sql-tab">Execute SQL Tab</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../app_db_explorer.html#sql-reference">SQL Reference</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../app_db_explorer.html#query-history-tab">Query History Tab</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../app_db_explorer.html#db-schema-tab">DB Schema Tab</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../app_db_explorer.html#example-queries-tab">Example Queries Tab</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../app_settings.html">App Settings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../app_settings.html#data">Data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../app_settings.html#parameters">Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../app_settings.html#id1">Parameters</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../app_settings.html#credentials">Credentials</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../app_settings.html#adding-removing-credentials">Adding &amp; Removing Credentials</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../app_settings.html#id2">Parameters</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../app_settings.html#clients">Clients</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../cli.html">CLI Commands</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../cli.html#run-the-web-server">Run the Web Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cli.html#run-from-a-configuration-file">Run from a Configuration File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cli.html#sync-local-database">Sync Local Database</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../seed_vault.html">seed_vault package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../seed_vault.html#subpackages">Subpackages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../seed_vault.cli.html">seed_vault.cli package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../seed_vault.enums.html">seed_vault.enums package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../seed_vault.models.html">seed_vault.models package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../seed_vault.service.html">seed_vault.service package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../seed_vault.ui.html">seed_vault.ui package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../seed_vault.utils.html">seed_vault.utils package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../seed_vault.html#module-seed_vault">Module contents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../fdsn_resources.html">FDSN Resources</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../fdsn_resources.html#station-web-service">Station Web Service</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../fdsn_resources.html#event-web-service">Event Web Service</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../fdsn_resources.html#dataselect-web-service">DataSelect Web Service</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../fdsn_resources.html#general-fdsn-web-services">General FDSN Web Services</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Seed Vault</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">seed_vault.service package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/docs/modules/seed_vault.service.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="seed-vault-service-package">
<h1>seed_vault.service package<a class="headerlink" href="#seed-vault-service-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-seed_vault.service.db">
<span id="seed-vault-service-db-module"></span><h2>seed_vault.service.db module<a class="headerlink" href="#module-seed_vault.service.db" title="Link to this heading"></a></h2>
<p>Database management module for the SEED-vault archive</p>
<p>This module provides a DatabaseManager class for handling seismic data storage in SQLite,
including archive data and arrival data. It implements connection management, data insertion,
querying, and database maintenance operations.</p>
<dl class="py class">
<dt class="sig sig-object py" id="seed_vault.service.db.DatabaseManager">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">seed_vault.service.db.</span></span><span class="sig-name descname"><span class="pre">DatabaseManager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/db.html#DatabaseManager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.db.DatabaseManager" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Manages seismic data storage and retrieval using SQLite.</p>
<p>This class handles database connections, table creation, data insertion,
and querying for seismic archive and arrival data.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="seed_vault.service.db.DatabaseManager.db_path">
<span class="sig-name descname"><span class="pre">db_path</span></span><a class="headerlink" href="#seed_vault.service.db.DatabaseManager.db_path" title="Link to this definition"></a></dt>
<dd><p>Path to the SQLite database file.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<p>Initialize DatabaseManager with database path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>db_path</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – Path where the SQLite database should be created/accessed.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="seed_vault.service.db.DatabaseManager.analyze_table">
<span class="sig-name descname"><span class="pre">analyze_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/db.html#DatabaseManager.analyze_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.db.DatabaseManager.analyze_table" title="Link to this definition"></a></dt>
<dd><p>Update table statistics for query optimization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>table_name</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – Name of the table to analyze.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="seed_vault.service.db.DatabaseManager.bulk_insert_archive_data">
<span class="sig-name descname"><span class="pre">bulk_insert_archive_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">archive_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/db.html#DatabaseManager.bulk_insert_archive_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.db.DatabaseManager.bulk_insert_archive_data" title="Link to this definition"></a></dt>
<dd><p>Insert multiple archive data records.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>archive_list</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>]</span>) – List of tuples containing archive data records.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Number of inserted records.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="seed_vault.service.db.DatabaseManager.bulk_insert_arrival_data">
<span class="sig-name descname"><span class="pre">bulk_insert_arrival_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arrival_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/db.html#DatabaseManager.bulk_insert_arrival_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.db.DatabaseManager.bulk_insert_arrival_data" title="Link to this definition"></a></dt>
<dd><p>Insert multiple arrival data records.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>arrival_list</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>]</span>) – List of tuples containing arrival data records.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Number of inserted records.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="seed_vault.service.db.DatabaseManager.check_data_existence">
<span class="sig-name descname"><span class="pre">check_data_existence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">netcode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stacode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">location</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">starttime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endtime</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/db.html#DatabaseManager.check_data_existence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.db.DatabaseManager.check_data_existence" title="Link to this definition"></a></dt>
<dd><p>Run a simple check to see if a db element exists for a trace</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>db_manager</strong> (<a class="reference internal" href="../../seed_vault.service.html#seed_vault.service.db.DatabaseManager" title="seed_vault.service.db.DatabaseManager"><em>DatabaseManager</em></a>) – Database manager instance</p></li>
<li><p><strong>network</strong> (<em>str</em>) – Network code</p></li>
<li><p><strong>station</strong> (<em>str</em>) – Station code</p></li>
<li><p><strong>location</strong> (<em>str</em>) – Location code</p></li>
<li><p><strong>channel</strong> (<em>str</em>) – Channel code</p></li>
<li><p><strong>start/endtime</strong> (<em>str</em>) – Time in iso</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if data exists for the specified parameters, False otherwise</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="seed_vault.service.db.DatabaseManager.connection">
<span class="sig-name descname"><span class="pre">connection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_retries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_delay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/db.html#DatabaseManager.connection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.db.DatabaseManager.connection" title="Link to this definition"></a></dt>
<dd><p>Context manager for database connections with retry mechanism.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_retries</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span>) – Maximum number of connection retry attempts.</p></li>
<li><p><strong>initial_delay</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></span>) – Initial delay between retries in seconds.</p></li>
</ul>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><em>sqlite3.Connection</em> – Database connection object.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sqlite3.OperationalError</strong> – If database connection fails after all retries.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="seed_vault.service.db.DatabaseManager.delete_elements">
<span class="sig-name descname"><span class="pre">delete_elements</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4102444799</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/db.html#DatabaseManager.delete_elements"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.db.DatabaseManager.delete_elements" title="Link to this definition"></a></dt>
<dd><p>Delete elements from specified table within time range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table_name</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – Name of the table (‘archive_data’ or ‘arrival_data’).</p></li>
<li><p><strong>start_time</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">datetime</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">UTCDateTime</span></code>]</span>) – Start time for deletion range.</p></li>
<li><p><strong>end_time</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">datetime</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">UTCDateTime</span></code>]</span>) – End time for deletion range.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Number of deleted rows.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If table_name is invalid or time format is incorrect.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="seed_vault.service.db.DatabaseManager.display_contents">
<span class="sig-name descname"><span class="pre">display_contents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4102444799</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/db.html#DatabaseManager.display_contents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.db.DatabaseManager.display_contents" title="Link to this definition"></a></dt>
<dd><p>Display contents of a specified table within a given time range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table_name</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – Name of the table to query (‘archive_data’ or ‘arrival_data’).</p></li>
<li><p><strong>start_time</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">datetime</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">UTCDateTime</span></code>]</span>) – Start time for the query.</p></li>
<li><p><strong>end_time</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">datetime</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">UTCDateTime</span></code>]</span>) – End time for the query.</p></li>
<li><p><strong>limit</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span>) – Maximum number of rows to return.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="seed_vault.service.db.DatabaseManager.execute_query">
<span class="sig-name descname"><span class="pre">execute_query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/db.html#DatabaseManager.execute_query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.db.DatabaseManager.execute_query" title="Link to this definition"></a></dt>
<dd><p>Execute an SQL query and return results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>query</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – SQL query to execute.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>bool: Whether an error occurred</p></li>
<li><p>str: Status message or error description</p></li>
<li><p>Optional[pd.DataFrame]: Results for SELECT queries, None otherwise</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple containing</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="seed_vault.service.db.DatabaseManager.fetch_arrivals_distances">
<span class="sig-name descname"><span class="pre">fetch_arrivals_distances</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resource_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">netcode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stacode</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/db.html#DatabaseManager.fetch_arrivals_distances"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.db.DatabaseManager.fetch_arrivals_distances" title="Link to this definition"></a></dt>
<dd><p>Retrieve arrival times and distance metrics for a specific event and station.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>resource_id</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – Unique identifier for the seismic event.</p></li>
<li><p><strong>netcode</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – Network code for the station.</p></li>
<li><p><strong>stacode</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – Station code.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tuple containing</dt><dd><p>(p_arrival, s_arrival, dist_km, dist_deg, azimuth), where:
- p_arrival: P wave arrival time (timestamp)
- s_arrival: S wave arrival time (timestamp)
- dist_km: Distance in kilometers
- dist_deg: Distance in degrees
- azimuth: Azimuth angle from event to station
Returns None if no matching record is found.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Tuple[float, float, float, float, float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="seed_vault.service.db.DatabaseManager.get_arrival_data">
<span class="sig-name descname"><span class="pre">get_arrival_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resource_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">netcode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stacode</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/db.html#DatabaseManager.get_arrival_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.db.DatabaseManager.get_arrival_data" title="Link to this definition"></a></dt>
<dd><p>Retrieve complete arrival data for a specific event and station.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>resource_id</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – Unique identifier for the seismic event.</p></li>
<li><p><strong>netcode</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – Network code for the station.</p></li>
<li><p><strong>stacode</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – Station code.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Dictionary containing all arrival data fields for the</dt><dd><p>specified event and station, or None if no matching record is found.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Dict[str, Any]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="seed_vault.service.db.DatabaseManager.get_events_for_station">
<span class="sig-name descname"><span class="pre">get_events_for_station</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">netcode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stacode</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/db.html#DatabaseManager.get_events_for_station"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.db.DatabaseManager.get_events_for_station" title="Link to this definition"></a></dt>
<dd><p>Retrieve all seismic events recorded by a specific station.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>netcode</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – Network code for the station.</p></li>
<li><p><strong>stacode</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – Station code.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>List of dictionaries containing arrival data for all</dt><dd><p>events recorded by the station. Returns empty list if no events found.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[Dict[str, Any]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="seed_vault.service.db.DatabaseManager.get_stations_for_event">
<span class="sig-name descname"><span class="pre">get_stations_for_event</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resource_id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/db.html#DatabaseManager.get_stations_for_event"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.db.DatabaseManager.get_stations_for_event" title="Link to this definition"></a></dt>
<dd><p>Retrieve all station data associated with a specific seismic event.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>resource_id</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – Unique identifier for the seismic event.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>List of dictionaries containing arrival data for all</dt><dd><p>stations that recorded the event. Returns empty list if no stations found.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[Dict[str, Any]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="seed_vault.service.db.DatabaseManager.join_continuous_segments">
<span class="sig-name descname"><span class="pre">join_continuous_segments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gap_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/db.html#DatabaseManager.join_continuous_segments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.db.DatabaseManager.join_continuous_segments" title="Link to this definition"></a></dt>
<dd><p>Join continuous data segments in the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>gap_tolerance</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></span>) – Maximum allowed gap (in seconds) to consider segments continuous.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="seed_vault.service.db.DatabaseManager.reindex_tables">
<span class="sig-name descname"><span class="pre">reindex_tables</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/db.html#DatabaseManager.reindex_tables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.db.DatabaseManager.reindex_tables" title="Link to this definition"></a></dt>
<dd><p>Reindex both of the tables in our DB</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="seed_vault.service.db.DatabaseManager.setup_database">
<span class="sig-name descname"><span class="pre">setup_database</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/db.html#DatabaseManager.setup_database"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.db.DatabaseManager.setup_database" title="Link to this definition"></a></dt>
<dd><p>Initialize database schema with required tables and indices.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="seed_vault.service.db.DatabaseManager.vacuum_database">
<span class="sig-name descname"><span class="pre">vacuum_database</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/db.html#DatabaseManager.vacuum_database"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.db.DatabaseManager.vacuum_database" title="Link to this definition"></a></dt>
<dd><p>Rebuild the database file to reclaim unused space.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.db.miniseed_to_db_elements">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.db.</span></span><span class="sig-name descname"><span class="pre">miniseed_to_db_elements</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/db.html#miniseed_to_db_elements"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.db.miniseed_to_db_elements" title="Link to this definition"></a></dt>
<dd><p>Convert a miniseed file to a database element tuple.</p>
<p>Processes a miniseed file and extracts relevant metadata for database storage.
Expects files in the format: network.station.location.channel.*.year.julday</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file_path</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – Path to the miniseed file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl>
<dt>A tuple containing:</dt><dd><ul class="simple">
<li><p>network: Network code</p></li>
<li><p>station: Station code</p></li>
<li><p>location: Location code</p></li>
<li><p>channel: Channel code</p></li>
<li><p>start_time: ISO format start time</p></li>
<li><p>end_time: ISO format end time</p></li>
</ul>
<p>Returns None if file is invalid or cannot be processed.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Tuple[str, str, str, str, str, str]]</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">element</span> <span class="o">=</span> <span class="n">miniseed_to_db_element</span><span class="p">(</span><span class="s2">&quot;/path/to/IU.ANMO.00.BHZ.D.2020.001&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">element</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">element</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.db.populate_database_from_files">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.db.</span></span><span class="sig-name descname"><span class="pre">populate_database_from_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cursor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_paths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/db.html#populate_database_from_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.db.populate_database_from_files" title="Link to this definition"></a></dt>
<dd><p>Insert or update MiniSEED file metadata into an SQL database.</p>
<p>Takes a list of SDS archive file paths, extracts metadata, and updates a database
tracking data availability. If data spans overlap with existing database entries,
the spans are merged. Uses miniseed_to_db_elements() to parse file metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cursor</strong> (<em>sqlite3.Cursor</em>) – Database cursor for executing SQL commands</p></li>
<li><p><strong>file_paths</strong> (<em>list</em><em>, </em><em>optional</em>) – List of paths to MiniSeed files. Defaults to empty list.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><dl class="simple">
<dt>Database must have an ‘archive_data’ table with columns:</dt><dd><ul>
<li><p>network (text)</p></li>
<li><p>station (text)</p></li>
<li><p>location (text)</p></li>
<li><p>channel (text)</p></li>
<li><p>starttime (integer): Unix timestamp</p></li>
<li><p>endtime (integer): Unix timestamp</p></li>
<li><p>importtime (integer): Unix timestamp of database insertion</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Handles overlapping time spans by merging them into a single entry</p></li>
<li><p>Sets importtime to current Unix timestamp</p></li>
<li><p>Skips files that fail metadata extraction (when miniseed_to_db_elements returns None)</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">sqlite3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;archive.db&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cursor</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;/path/to/IU.ANMO.00.BHZ.mseed&#39;</span><span class="p">,</span> <span class="s1">&#39;/path/to/IU.ANMO.00.BHN.mseed&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">populate_database_from_files</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">files</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.db.populate_database_from_files_dumb">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.db.</span></span><span class="sig-name descname"><span class="pre">populate_database_from_files_dumb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cursor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_paths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/db.html#populate_database_from_files_dumb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.db.populate_database_from_files_dumb" title="Link to this definition"></a></dt>
<dd><p>Simple version of database population from MiniSEED files without span merging.</p>
<p>A simplified “dumb” version that blindly replaces existing database entries
with identical network/station/location/channel codes, rather than checking for
and merging overlapping time spans.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cursor</strong> (<em>sqlite3.Cursor</em>) – Database cursor for executing SQL commands</p></li>
<li><p><strong>file_paths</strong> (<em>list</em><em>, </em><em>optional</em>) – List of paths to MiniSeed files. Defaults to empty list.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.db.populate_database_from_sds">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.db.</span></span><span class="sig-name descname"><span class="pre">populate_database_from_sds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sds_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">db_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_patterns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['??.*.*.???.?.????.???']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newer_than</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_processes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gap_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">60</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/db.html#populate_database_from_sds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.db.populate_database_from_sds" title="Link to this definition"></a></dt>
<dd><p>Scan an SDS archive directory and populate a database with data availability.</p>
<p>Recursively searches an SDS (Seismic Data Structure) archive for MiniSEED files,
extracts their metadata, and records data availability in a SQLite database.
Supports parallel processing and can optionally filter for recently modified files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sds_path</strong> (<em>str</em>) – Path to the root SDS archive directory</p></li>
<li><p><strong>db_path</strong> (<em>str</em>) – Path to the SQLite database file</p></li>
<li><p><strong>search_patterns</strong> (<em>list</em><em>, </em><em>optional</em>) – List of file patterns to match.
Defaults to [“??.*.*.???.?.????.???”] (standard SDS naming pattern).</p></li>
<li><p><strong>newer_than</strong> (<em>str</em><em> or </em><em>UTCDateTime</em><em>, </em><em>optional</em>) – Only process files modified after
this time. Defaults to None (process all files).</p></li>
<li><p><strong>num_processes</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of parallel processes to use.
Defaults to None (use all available CPU cores).</p></li>
<li><p><strong>gap_tolerance</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum time gap in seconds between segments
that should be considered continuous. Defaults to 60.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Uses DatabaseManager class to handle database operations</p></li>
<li><dl class="simple">
<dt>Attempts multiprocessing but falls back to single process if it fails</dt><dd><p>(common on OSX and Windows)</p>
</dd>
</dl>
</li>
<li><p>Follows symbolic links when walking directory tree</p></li>
<li><p>Files are processed using miniseed_to_db_elements() function</p></li>
<li><p>After insertion, continuous segments are joined based on gap_tolerance</p></li>
<li><p>Progress is displayed using tqdm progress bars</p></li>
<li><p>If newer_than is provided, it’s converted to a Unix timestamp for comparison</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>RuntimeError</strong> – If bulk insertion into database fails</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.db.stream_to_db_elements">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.db.</span></span><span class="sig-name descname"><span class="pre">stream_to_db_elements</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">st</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/db.html#stream_to_db_elements"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.db.stream_to_db_elements" title="Link to this definition"></a></dt>
<dd><p>Convert an ObsPy Stream object to multiple database element tuples, properly handling gaps.
Creates database elements from a stream, assuming all traces have the same
Network-Station-Location-Channel (NSLC) codes (e.g. an SDS file).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>st</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code></span>) – ObsPy Stream object containing seismic traces.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl>
<dt>A list of tuples, each containing:</dt><dd><ul class="simple">
<li><p>network: Network code</p></li>
<li><p>station: Station code</p></li>
<li><p>location: Location code</p></li>
<li><p>channel: Channel code</p></li>
<li><p>start_time: ISO format start time</p></li>
<li><p>end_time: ISO format end time</p></li>
</ul>
<p>Returns empty list if stream is empty.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[Tuple[str, str, str, str, str, str]]</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stream</span> <span class="o">=</span> <span class="n">obspy</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">elements</span> <span class="o">=</span> <span class="n">stream_to_db_element</span><span class="p">(</span><span class="n">stream</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">element</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-seed_vault.service.events">
<span id="seed-vault-service-events-module"></span><h2>seed_vault.service.events module<a class="headerlink" href="#module-seed_vault.service.events" title="Link to this heading"></a></h2>
<p>The events service should get the events based on a selection (filter) settings.
UI should generate the selection and pass it here. We need a single function
here that gets the selection and runs Rob’s script.</p>
<p>We should also be able to support multi-select areas.</p>
<p>&#64;TODO: For now, dummy scripts are used. &#64;Yunlong to fix.</p>
<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.events.event_response_to_df">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.events.</span></span><span class="sig-name descname"><span class="pre">event_response_to_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/events.html#event_response_to_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.events.event_response_to_df" title="Link to this definition"></a></dt>
<dd><p>&#64;TODO: base on response from FSDN, below should be re-written</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.events.get_event_data">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.events.</span></span><span class="sig-name descname"><span class="pre">get_event_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">settings</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/events.html#get_event_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.events.get_event_data" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.events.remove_duplicate_events">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.events.</span></span><span class="sig-name descname"><span class="pre">remove_duplicate_events</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">events</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/events.html#remove_duplicate_events"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.events.remove_duplicate_events" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="seed-vault-service-gen-config-models-module">
<h2>seed_vault.service.gen_config_models module<a class="headerlink" href="#seed-vault-service-gen-config-models-module" title="Link to this heading"></a></h2>
</section>
<section id="module-seed_vault.service.seismoloader">
<span id="seed-vault-service-seismoloader-module"></span><h2>seed_vault.service.seismoloader module<a class="headerlink" href="#module-seed_vault.service.seismoloader" title="Link to this heading"></a></h2>
<p>The main functions for SEED-vault, from original CLI-only version (Pickle 2024)</p>
<dl class="py class">
<dt class="sig sig-object py" id="seed_vault.service.seismoloader.CustomConfigParser">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">seed_vault.service.seismoloader.</span></span><span class="sig-name descname"><span class="pre">CustomConfigParser</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/seismoloader.html#CustomConfigParser"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.seismoloader.CustomConfigParser" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ConfigParser</span></code></p>
<p>Custom configuration parser that can preserve case sensitivity for specified sections.</p>
<p>This class extends the standard ConfigParser to allow certain sections to maintain
case sensitivity while others are converted to lowercase.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="seed_vault.service.seismoloader.CustomConfigParser.case_sensitive_sections">
<span class="sig-name descname"><span class="pre">case_sensitive_sections</span></span><a class="headerlink" href="#seed_vault.service.seismoloader.CustomConfigParser.case_sensitive_sections" title="Link to this definition"></a></dt>
<dd><p>Set of section names that should preserve case sensitivity.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>set</p>
</dd>
</dl>
</dd></dl>

<p>Initialize the CustomConfigParser.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> – Variable length argument list passed to ConfigParser.</p></li>
<li><p><strong>**kwargs</strong> – Arbitrary keyword arguments passed to ConfigParser.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="seed_vault.service.seismoloader.CustomConfigParser.optionxform">
<span class="sig-name descname"><span class="pre">optionxform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optionstr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/seismoloader.html#CustomConfigParser.optionxform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.seismoloader.CustomConfigParser.optionxform" title="Link to this definition"></a></dt>
<dd><p>Transform option names during parsing.</p>
<p>Overrides the default behavior to preserve the original string case.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>optionstr</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – The option string to transform.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The original string unchanged.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.seismoloader.archive_request">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.seismoloader.</span></span><span class="sig-name descname"><span class="pre">archive_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">waveform_clients</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sds_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">db_manager</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/seismoloader.html#archive_request"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.seismoloader.archive_request" title="Link to this definition"></a></dt>
<dd><p>Download seismic data for a request and archive it in SDS format.</p>
<p>Retrieves waveform data from FDSN web services, saves it in SDS format,
and updates the database. Handles authentication, data merging, and
various error conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>request</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]</span>) – Tuple containing (network, station, location, channel,
start_time, end_time)</p></li>
<li><p><strong>waveform_clients</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Client</span></code>]</span>) – Dictionary mapping network codes to FDSN clients.
Special key ‘open’ is used for default client.</p></li>
<li><p><strong>sds_path</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – Root path of the SDS archive.</p></li>
<li><p><strong>db_manager</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="../../seed_vault.service.html#seed_vault.service.db.DatabaseManager" title="seed_vault.service.db.DatabaseManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">DatabaseManager</span></code></a></span>) – DatabaseManager instance for updating the database.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Supports per-network and per-station authentication</p></li>
<li><p>Handles splitting of large station list requests</p></li>
<li><p>Performs data merging when files already exist</p></li>
<li><p>Attempts STEIM2 compression, falls back to uncompressed format</p></li>
<li><p>Groups traces by day to handle fragmented data efficiently</p></li>
</ul>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">clients</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;IU&#39;</span><span class="p">:</span> <span class="n">Client</span><span class="p">(</span><span class="s1">&#39;IRIS&#39;</span><span class="p">),</span> <span class="s1">&#39;open&#39;</span><span class="p">:</span> <span class="n">Client</span><span class="p">(</span><span class="s1">&#39;IRIS&#39;</span><span class="p">)}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">request</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;IU&quot;</span><span class="p">,</span> <span class="s2">&quot;ANMO&quot;</span><span class="p">,</span> <span class="s2">&quot;00&quot;</span><span class="p">,</span> <span class="s2">&quot;BHZ&quot;</span><span class="p">,</span> <span class="s2">&quot;2020-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2020-01-02&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">archive_request</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">clients</span><span class="p">,</span> <span class="s2">&quot;/data/seismic&quot;</span><span class="p">,</span> <span class="n">db_manager</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.seismoloader.collect_requests">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.seismoloader.</span></span><span class="sig-name descname"><span class="pre">collect_requests</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">days_per_request</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cha_pref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc_pref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/seismoloader.html#collect_requests"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.seismoloader.collect_requests" title="Link to this definition"></a></dt>
<dd><p>Generate time-windowed data requests for all channels in an inventory.</p>
<p>Creates a list of data requests by breaking a time period into smaller windows
and collecting station metadata for each window. Can optionally filter for
preferred channels and location codes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inv</strong> (<em>obspy.core.inventory.Inventory</em>) – Station inventory to generate requests for</p></li>
<li><p><strong>time0</strong> (<em>obspy.UTCDateTime</em>) – Start time for data requests</p></li>
<li><p><strong>time1</strong> (<em>obspy.UTCDateTime</em>) – End time for data requests</p></li>
<li><p><strong>days_per_request</strong> (<em>int</em><em>, </em><em>optional</em>) – Length of each request window in days.
Defaults to 3.</p></li>
<li><p><strong>cha_pref</strong> (<em>list</em><em>, </em><em>optional</em>) – List of preferred channel codes in priority order.
If provided, only these channels will be requested. Defaults to None.</p></li>
<li><p><strong>loc_pref</strong> (<em>list</em><em>, </em><em>optional</em>) – List of preferred location codes in priority order.
If provided, only these location codes will be requested. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl>
<dt>List of tuples containing request parameters:</dt><dd><dl class="simple">
<dt>(network_code, station_code, location_code, channel_code,</dt><dd><p>start_time_iso, end_time_iso)</p>
</dd>
</dl>
<p>Returns None if start time is greater than or equal to end time.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list or None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>End time is capped at 120 seconds before current time</p></li>
<li><p>Times in returned tuples are ISO formatted strings with ‘Z’ suffix</p></li>
<li><p>Uses get_preferred_channels() if cha_pref or loc_pref are specified</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">obspy</span><span class="w"> </span><span class="kn">import</span> <span class="n">UTCDateTime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t0</span> <span class="o">=</span> <span class="n">UTCDateTime</span><span class="p">(</span><span class="s2">&quot;2020-01-01&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t1</span> <span class="o">=</span> <span class="n">UTCDateTime</span><span class="p">(</span><span class="s2">&quot;2020-01-10&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">requests</span> <span class="o">=</span> <span class="n">collect_requests</span><span class="p">(</span><span class="n">inventory</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">days_per_request</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">cha_pref</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;HHZ&#39;</span><span class="p">,</span> <span class="s1">&#39;BHZ&#39;</span><span class="p">],</span>
<span class="gp">... </span>                          <span class="n">loc_pref</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;00&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.seismoloader.collect_requests_event">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.seismoloader.</span></span><span class="sig-name descname"><span class="pre">collect_requests_event</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/seismoloader.html#collect_requests_event"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.seismoloader.collect_requests_event" title="Link to this definition"></a></dt>
<dd><p>Collect data requests and arrival times for an event at multiple stations.</p>
<p>For a given earthquake event, calculates arrival times and generates data
requests for all appropriate stations in the inventory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eq</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Event</span></code></span>) – ObsPy Event object containing earthquake information.</p></li>
<li><p><strong>inv</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Inventory</span></code></span>) – ObsPy Inventory object containing station information.</p></li>
<li><p><strong>model</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">TauPyModel</span></code>]</span>) – Optional TauPyModel for travel time calculations.
If None, uses model from settings or falls back to IASP91.</p></li>
<li><p><strong>settings</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="../../seed_vault.models.html#seed_vault.models.config.SeismoLoaderSettings" title="seed_vault.models.config.SeismoLoaderSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeismoLoaderSettings</span></code></a>]</span>) – Optional SeismoLoaderSettings object containing configuration.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>List of request tuples (net, sta, loc, chan, start, end)</p></li>
<li><p>List of arrival data tuples for database</p></li>
<li><p>Dictionary mapping “net.sta” to P-arrival timestamps</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple containing</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Requires a DatabaseManager instance to check for existing arrivals.
Time windows are constructed around P-wave arrivals using settings.
Handles both new calculations and retrieving existing arrival times.</p>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">event</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_events</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inventory</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_stations</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="s2">&quot;IU&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">requests</span><span class="p">,</span> <span class="n">arrivals</span><span class="p">,</span> <span class="n">p_times</span> <span class="o">=</span> <span class="n">collect_requests_event</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">event</span><span class="p">,</span> <span class="n">inventory</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">TauPyModel</span><span class="p">(</span><span class="s2">&quot;iasp91&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.seismoloader.combine_requests">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.seismoloader.</span></span><span class="sig-name descname"><span class="pre">combine_requests</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requests</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/seismoloader.html#combine_requests"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.seismoloader.combine_requests" title="Link to this definition"></a></dt>
<dd><p>Combine multiple data requests for efficiency.</p>
<p>Groups requests by network and time range, combining stations, locations,
and channels into comma-separated lists to minimize the number of requests.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>requests</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]</span>) – List of request tuples, each containing:
(network, station, location, channel, start_time, end_time)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of combined request tuples with the same structure but with
station, location, and channel fields potentially containing
comma-separated lists.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">original</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="p">(</span><span class="s2">&quot;IU&quot;</span><span class="p">,</span> <span class="s2">&quot;ANMO&quot;</span><span class="p">,</span> <span class="s2">&quot;00&quot;</span><span class="p">,</span> <span class="s2">&quot;BHZ&quot;</span><span class="p">,</span> <span class="s2">&quot;2020-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2020-01-02&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">(</span><span class="s2">&quot;IU&quot;</span><span class="p">,</span> <span class="s2">&quot;COLA&quot;</span><span class="p">,</span> <span class="s2">&quot;00&quot;</span><span class="p">,</span> <span class="s2">&quot;BHZ&quot;</span><span class="p">,</span> <span class="s2">&quot;2020-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2020-01-02&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">combined</span> <span class="o">=</span> <span class="n">combine_requests</span><span class="p">(</span><span class="n">original</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">combined</span><span class="p">)</span>
<span class="go">[(&quot;IU&quot;, &quot;ANMO,COLA&quot;, &quot;00&quot;, &quot;BHZ&quot;, &quot;2020-01-01&quot;, &quot;2020-01-02&quot;)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.seismoloader.get_events">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.seismoloader.</span></span><span class="sig-name descname"><span class="pre">get_events</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">settings</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/seismoloader.html#get_events"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.seismoloader.get_events" title="Link to this definition"></a></dt>
<dd><p>Retrieve seismic event catalogs based on configured criteria.</p>
<p>Queries FDSN web services or loads local catalogs for seismic events matching
specified criteria including time range, magnitude, depth, and geographic constraints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>settings</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="../../seed_vault.models.html#seed_vault.models.config.SeismoLoaderSettings" title="seed_vault.models.config.SeismoLoaderSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeismoLoaderSettings</span></code></a></span>) – Configuration settings containing event search criteria,
client information, and filtering preferences.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Catalog</span></code>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of ObsPy Catalog objects containing matching events.
Returns empty catalog if no events found.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>FileNotFoundError</strong> – If local catalog file not found.</p></li>
<li><p><strong>PermissionError</strong> – If unable to access local catalog file.</p></li>
<li><p><strong>ValueError</strong> – If invalid geographic constraint type specified.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">settings</span> <span class="o">=</span> <span class="n">SeismoLoaderSettings</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">settings</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">min_magnitude</span> <span class="o">=</span> <span class="mf">5.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">catalogs</span> <span class="o">=</span> <span class="n">get_events</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.seismoloader.get_missing_from_request">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.seismoloader.</span></span><span class="sig-name descname"><span class="pre">get_missing_from_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db_manager</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eq_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requests</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">st</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/seismoloader.html#get_missing_from_request"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.seismoloader.get_missing_from_request" title="Link to this definition"></a></dt>
<dd><p>Compare requested seismic data against what’s present in a Stream.
Handles comma-separated values for location and channel codes.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></span></p>
</dd>
</dl>
<section id="parameters">
<h3>Parameters:<a class="headerlink" href="#parameters" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>eq_id<span class="classifier">str</span></dt><dd><p>Earthquake ID to use as dictionary key</p>
</dd>
<dt>requests<span class="classifier">List[Tuple]</span></dt><dd><p>List of request tuples, each containing (network, station, location, channel, starttime, endtime)</p>
</dd>
<dt>st<span class="classifier">Stream</span></dt><dd><p>ObsPy Stream object containing seismic traces</p>
</dd>
</dl>
</section>
<section id="returns">
<h3>Returns:<a class="headerlink" href="#returns" title="Link to this heading"></a></h3>
<p>:
dict</p>
<blockquote>
<div><p>Nested dictionary with structure:
{eq_id: {</p>
<blockquote>
<div><p>“network.station”: value,
“network2.station2”: value2,
…</p>
</div></blockquote>
<p>}}
where value is either:
- list of missing channel strings (“network.station.location.channel”)
- “Not Attempted” if stream is empty
- “ALL” if all requested channels are missing
- [] if all requested channels are present</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.seismoloader.get_p_s_times">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.seismoloader.</span></span><span class="sig-name descname"><span class="pre">get_p_s_times</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_deg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ttmodel</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/seismoloader.html#get_p_s_times"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.seismoloader.get_p_s_times" title="Link to this definition"></a></dt>
<dd><p>Calculate theoretical P and S wave arrival times for an earthquake at a given distance.</p>
<p>Uses a travel time model to compute the first P and S wave arrivals for a given
earthquake and distance. The first arrival (labeled as “P”) may not necessarily be
a direct P wave. For S waves, only phases explicitly labeled as ‘S’ are considered.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eq</strong> (<em>obspy.core.event.Event</em>) – Earthquake event object containing origin time
and depth information</p></li>
<li><p><strong>dist_deg</strong> (<em>float</em>) – Distance between source and receiver in degrees</p></li>
<li><p><strong>ttmodel</strong> (<em>obspy.taup.TauPyModel</em>) – Travel time model to use for calculations</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing:</dt><dd><ul class="simple">
<li><p>(UTCDateTime or None): Time of first arrival (“P” wave)</p></li>
<li><p>(UTCDateTime or None): Time of first S wave arrival
Returns (None, None) if travel time calculation fails</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Earthquake depth is expected in meters in the QuakeML format and is
converted to kilometers for the travel time calculations</p></li>
<li><p>For S waves, only searches for explicit ‘S’ phase arrivals</p></li>
<li><p>Warns if no P arrival is found at any distance</p></li>
<li><p>Warns if no S arrival is found at distances ≤ 90 degrees</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">obspy.taup</span><span class="w"> </span><span class="kn">import</span> <span class="n">TauPyModel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">TauPyModel</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;iasp91&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p_time</span><span class="p">,</span> <span class="n">s_time</span> <span class="o">=</span> <span class="n">get_p_s_times</span><span class="p">(</span><span class="n">earthquake</span><span class="p">,</span> <span class="mf">45.3</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.seismoloader.get_preferred_channels">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.seismoloader.</span></span><span class="sig-name descname"><span class="pre">get_preferred_channels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cha_rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc_rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/seismoloader.html#get_preferred_channels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.seismoloader.get_preferred_channels" title="Link to this definition"></a></dt>
<dd><p>Select the best available channels from an FDSN inventory based on rankings.</p>
<p>Filters an inventory to keep only the preferred channels based on channel code
and location code rankings. For each component (Z, N, E), selects the channel
with the highest ranking.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inv</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Inventory</span></code></span>) – ObsPy Inventory object to filter.</p></li>
<li><p><strong>cha_rank</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]</span>) – List of channel codes in order of preference (e.g., [‘BH’, ‘HH’]).
Lower index means higher preference.</p></li>
<li><p><strong>loc_rank</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]</span>) – List of location codes in order of preference (e.g., [‘’, ‘00’]).
Lower index means higher preference. ‘–’ is treated as empty string.</p></li>
<li><p><strong>time</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">UTCDateTime</span></code>]</span>) – Optional time to filter channel availability at that time.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Inventory</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Filtered ObsPy Inventory containing only the preferred channels.
If all channels would be filtered out, returns original station.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Channel preference takes precedence over location preference.
If neither cha_rank nor loc_rank is provided, returns original inventory.</p>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">inventory</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_stations</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="s2">&quot;IU&quot;</span><span class="p">,</span> <span class="n">station</span><span class="o">=</span><span class="s2">&quot;ANMO&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cha_rank</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;BH&#39;</span><span class="p">,</span> <span class="s1">&#39;HH&#39;</span><span class="p">,</span> <span class="s1">&#39;EH&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loc_rank</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;00&#39;</span><span class="p">,</span> <span class="s1">&#39;10&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered</span> <span class="o">=</span> <span class="n">get_preferred_channels</span><span class="p">(</span><span class="n">inventory</span><span class="p">,</span> <span class="n">cha_rank</span><span class="p">,</span> <span class="n">loc_rank</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.seismoloader.get_selected_stations_at_channel_level">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.seismoloader.</span></span><span class="sig-name descname"><span class="pre">get_selected_stations_at_channel_level</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">settings</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/seismoloader.html#get_selected_stations_at_channel_level"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.seismoloader.get_selected_stations_at_channel_level" title="Link to this definition"></a></dt>
<dd><p>Update inventory information to include channel-level details for selected stations.</p>
<p>Retrieves detailed channel information for each station in the selected inventory
using the specified FDSN client.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>settings</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="../../seed_vault.models.html#seed_vault.models.config.SeismoLoaderSettings" title="seed_vault.models.config.SeismoLoaderSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeismoLoaderSettings</span></code></a></span>) – Configuration settings containing station selection and client information.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="../../seed_vault.models.html#seed_vault.models.config.SeismoLoaderSettings" title="seed_vault.models.config.SeismoLoaderSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeismoLoaderSettings</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Updated settings with refined station inventory including channel information.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">settings</span> <span class="o">=</span> <span class="n">SeismoLoaderSettings</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">settings</span> <span class="o">=</span> <span class="n">get_selected_stations_at_channel_level</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.seismoloader.get_stations">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.seismoloader.</span></span><span class="sig-name descname"><span class="pre">get_stations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">settings</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/seismoloader.html#get_stations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.seismoloader.get_stations" title="Link to this definition"></a></dt>
<dd><p>Retrieve station inventory based on configured criteria.</p>
<p>Gets station information from FDSN web services or local inventory based on
settings, including geographic constraints, network/station filters, and channel
preferences.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>settings</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="../../seed_vault.models.html#seed_vault.models.config.SeismoLoaderSettings" title="seed_vault.models.config.SeismoLoaderSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeismoLoaderSettings</span></code></a></span>) – Configuration settings containing station selection criteria,
client information, and filtering preferences.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Inventory</span></code>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Inventory containing matching stations, or None if no stations found
or if station service is unavailable.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The function applies several layers of filtering:
1. Basic network/station/location/channel criteria
2. Geographic constraints (if specified)
3. Station exclusions/inclusions
4. Channel and location preferences
5. Sample rate filtering</p>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">settings</span> <span class="o">=</span> <span class="n">SeismoLoaderSettings</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">settings</span><span class="o">.</span><span class="n">station</span><span class="o">.</span><span class="n">network</span> <span class="o">=</span> <span class="s2">&quot;IU&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inventory</span> <span class="o">=</span> <span class="n">get_stations</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.seismoloader.prune_requests">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.seismoloader.</span></span><span class="sig-name descname"><span class="pre">prune_requests</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requests</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">db_manager</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sds_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_request_window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/seismoloader.html#prune_requests"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.seismoloader.prune_requests" title="Link to this definition"></a></dt>
<dd><p>Remove overlapping requests where data already exists in the archive.</p>
<p>Checks both the database and filesystem for existing data and removes or
splits requests to avoid re-downloading data that should be there already.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>requests</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]</span>) – List of request tuples containing:
(network, station, location, channel, start_time, end_time)</p></li>
<li><p><strong>db_manager</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="../../seed_vault.service.html#seed_vault.service.db.DatabaseManager" title="seed_vault.service.db.DatabaseManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">DatabaseManager</span></code></a></span>) – DatabaseManager instance for querying existing data.</p></li>
<li><p><strong>sds_path</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – Root path of the SDS archive.</p></li>
<li><p><strong>min_request_window</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></span>) – Minimum time window in seconds to keep a request.
Requests shorter than this are discarded. Default is 3 seconds.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of pruned request tuples, sorted by start time, network, and station.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function will update the database if it finds files in the SDS
structure that aren’t yet recorded in the database.</p>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">requests</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;IU&quot;</span><span class="p">,</span> <span class="s2">&quot;ANMO&quot;</span><span class="p">,</span> <span class="s2">&quot;00&quot;</span><span class="p">,</span> <span class="s2">&quot;BHZ&quot;</span><span class="p">,</span> <span class="s2">&quot;2020-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2020-01-02&quot;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pruned</span> <span class="o">=</span> <span class="n">prune_requests</span><span class="p">(</span><span class="n">requests</span><span class="p">,</span> <span class="n">db_manager</span><span class="p">,</span> <span class="s2">&quot;/data/SDS&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.seismoloader.read_config">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.seismoloader.</span></span><span class="sig-name descname"><span class="pre">read_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/seismoloader.html#read_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.seismoloader.read_config" title="Link to this definition"></a></dt>
<dd><p>Read and process a configuration file with case-sensitive handling for specific sections.</p>
<p>Reads a configuration file and processes it such that certain sections
(AUTH, DATABASE, SDS, WAVEFORM) preserve their case sensitivity while
other sections are converted to lowercase.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config_file</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – Path to the configuration file to read.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Processed configuration with appropriate case handling</dt><dd><p>for different sections.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../../seed_vault.service.html#seed_vault.service.seismoloader.CustomConfigParser" title="seed_vault.service.seismoloader.CustomConfigParser">CustomConfigParser</a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">config</span> <span class="o">=</span> <span class="n">read_config</span><span class="p">(</span><span class="s2">&quot;config.ini&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">auth_value</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;AUTH&quot;</span><span class="p">,</span> <span class="s2">&quot;ApiKey&quot;</span><span class="p">)</span>  <span class="c1"># Case preserved</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other_value</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;settings&quot;</span><span class="p">,</span> <span class="s2">&quot;parameter&quot;</span><span class="p">)</span>  <span class="c1"># Converted to lowercase</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.seismoloader.run_continuous">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.seismoloader.</span></span><span class="sig-name descname"><span class="pre">run_continuous</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">settings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_event</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/seismoloader.html#run_continuous"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.seismoloader.run_continuous" title="Link to this definition"></a></dt>
<dd><p>Retrieves continuous seismic data over long time intervals for a set of stations
defined by the <cite>inv</cite> parameter. The function manages multiple steps including
generating data requests, pruning unnecessary requests based on existing data,
combining requests for efficiency, and finally archiving the retrieved data.</p>
<p>The function uses a client setup based on the configuration in <cite>settings</cite> to
handle different data sources and authentication methods. Errors during client
creation or data retrieval are handled gracefully, with issues logged to the console.</p>
<p>Parameters:
- settings (SeismoLoaderSettings): Configuration settings containing client information,</p>
<blockquote>
<div><p>authentication details, and database paths necessary for data retrieval and storage.
This should include the start and end times for data collection, database path,
and SDS archive path among other configurations.</p>
</div></blockquote>
<ul class="simple">
<li><p>stop_event (threading.Event): Optional event flag for canceling the operation mid-execution.
If provided and set, the function will terminate gracefully at the next safe point.</p></li>
</ul>
<p>Workflow:
1. Initialize clients for waveform data retrieval.
2. Retrieve station information based on settings.
3. Collect initial data requests for the given time interval.
4. Prune requests based on existing data in the database to avoid redundancy.
5. Combine similar requests to minimize the number of individual operations.
6. Update or create clients based on specific network credentials if necessary.
7. Execute data retrieval requests, archive data to disk, and update the database.</p>
<p>Raises:
- Exception: General exceptions could be raised due to misconfiguration, unsuccessful</p>
<blockquote>
<div><p>data retrieval or client initialization errors. These exceptions are caught and logged,
but not re-raised, allowing the process to continue with other requests.</p>
</div></blockquote>
<p>Notes:
- It is crucial to ensure that the settings object is correctly configured, especially</p>
<blockquote>
<div><p>the client details and authentication credentials to avoid runtime errors.</p>
</div></blockquote>
<ul class="simple">
<li><p>The function logs detailed information about the processing steps and errors to aid
in debugging and monitoring of data retrieval processes.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.seismoloader.run_event">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.seismoloader.</span></span><span class="sig-name descname"><span class="pre">run_event</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">settings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_event</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/seismoloader.html#run_event"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.seismoloader.run_event" title="Link to this definition"></a></dt>
<dd><p>Processes and downloads seismic event data for each event in the provided catalog using
the specified settings and station inventory. The function manages multiple steps including
data requests, arrival time calculations, database updates, and data retrieval.</p>
<p>The function handles data retrieval from FDSN web services with support for authenticated
access and restricted data. Processing can be interrupted via the stop_event parameter,
and errors during execution are handled gracefully with detailed logging.</p>
<p>Parameters:
- settings (SeismoLoaderSettings): Configuration settings that include client details,</p>
<blockquote>
<div><p>authentication credentials, event-specific parameters like radius and time window,
and paths for data storage.</p>
</div></blockquote>
<ul class="simple">
<li><p>stop_event (threading.Event): Optional event flag for canceling the operation mid-execution.
If provided and set, the function will terminate gracefully at the next safe point.</p></li>
</ul>
<p>Workflow:
1. Initialize paths and database connections
2. Load appropriate travel time model for arrival calculations
3. Process each event in the catalog:</p>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>Calculate arrival times and generate data requests</p></li>
<li><p>Update arrival information in database</p></li>
<li><p>Check for existing data and prune redundant requests</p></li>
<li><p>Download and archive new data</p></li>
<li><p>Add event metadata to traces (arrivals, distances, azimuths)</p></li>
</ol>
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p>Combine data into event streams with complete metadata</p></li>
</ol>
<p>Returns:
- List[obspy.Stream]: List of streams, each containing data for one event with</p>
<blockquote>
<div><p>complete metadata including arrival times, distances, and azimuths. Returns None
if operation is canceled or no data is processed.</p>
</div></blockquote>
<p>Raises:
- Exception: General exceptions from client creation, data retrieval, or processing</p>
<blockquote>
<div><p>are caught and logged but not re-raised, allowing processing to continue with
remaining events.</p>
</div></blockquote>
<p>Notes:
- The function supports threading and can be safely interrupted via stop_event
- Station metadata is enriched with event-specific information including arrivals
- Data is archived in SDS format and the database is updated accordingly
- Each stream in the output includes complete event metadata for analysis</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.seismoloader.run_main">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.seismoloader.</span></span><span class="sig-name descname"><span class="pre">run_main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_event</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/seismoloader.html#run_main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.seismoloader.run_main" title="Link to this definition"></a></dt>
<dd><p>Main entry point for seismic data retrieval and processing.</p>
<p>Coordinates the overall workflow for retrieving and processing seismic data,
handling both continuous and event-based data collection based on settings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>settings</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="../../seed_vault.models.html#seed_vault.models.config.SeismoLoaderSettings" title="seed_vault.models.config.SeismoLoaderSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeismoLoaderSettings</span></code></a>]</span>) – Configuration settings for data retrieval and processing.
If None, settings must be provided via from_file.</p></li>
<li><p><strong>from_file</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]</span>) – Path to configuration file to load settings from.
Only used if settings is None.</p></li>
<li><p><strong>stop_event</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Event</span></code>]</span>) – Optional event flag for canceling the operation mid-execution.
If provided and set, the function will terminate gracefully at the next safe point.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The result from run_continuous or run_event, or None if cancelled.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Using settings object</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">settings</span> <span class="o">=</span> <span class="n">SeismoLoaderSettings</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">settings</span><span class="o">.</span><span class="n">download_type</span> <span class="o">=</span> <span class="n">DownloadType</span><span class="o">.</span><span class="n">EVENT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">run_main</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Using configuration file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">run_main</span><span class="p">(</span><span class="n">from_file</span><span class="o">=</span><span class="s2">&quot;config.ini&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.seismoloader.select_highest_samplerate">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.seismoloader.</span></span><span class="sig-name descname"><span class="pre">select_highest_samplerate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minSR</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/seismoloader.html#select_highest_samplerate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.seismoloader.select_highest_samplerate" title="Link to this definition"></a></dt>
<dd><p>Filters an inventory to keep only the highest sample rate channels where duplicates exist.</p>
<p>For each station in the inventory, this function identifies duplicate channels (those sharing
the same location code) and keeps only those with the highest sample rate. Channels must
meet the minimum sample rate requirement to be considered.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inv</strong> (<em>obspy.core.inventory.Inventory</em>) – Input inventory object</p></li>
<li><p><strong>minSR</strong> (<em>float</em><em>, </em><em>optional</em>) – Minimum sample rate in Hz. Defaults to 10.</p></li>
<li><p><strong>time</strong> (<em>obspy.UTCDateTime</em><em>, </em><em>optional</em>) – Specific time to check channel existence.
If provided, channels are considered duplicates if they share the same
location code and both exist at that time. If None, channels are considered
duplicates if they share the same location code and time span. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Filtered inventory containing only the highest</dt><dd><p>sample rate channels where duplicates existed.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>obspy.core.inventory.Inventory</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Filter inventory keeping only highest sample rate channels</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered_inv</span> <span class="o">=</span> <span class="n">select_highest_samplerate</span><span class="p">(</span><span class="n">inv</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Filter for a specific time, minimum 1 Hz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">obspy</span><span class="w"> </span><span class="kn">import</span> <span class="n">UTCDateTime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span> <span class="o">=</span> <span class="n">UTCDateTime</span><span class="p">(</span><span class="s2">&quot;2020-01-01&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered_inv</span> <span class="o">=</span> <span class="n">select_highest_samplerate</span><span class="p">(</span><span class="n">inv</span><span class="p">,</span> <span class="n">minSR</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Channel duplicates are determined by location code and either:
* Existence at a specific time (if time is provided)
* Having identical time spans (if time is None)</p></li>
<li><p>All retained channels must have sample rates &gt;= minSR</p></li>
<li><p>For duplicate channels, all channels with the highest sample rate are kept</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.seismoloader.setup_paths">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.seismoloader.</span></span><span class="sig-name descname"><span class="pre">setup_paths</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">settings</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/seismoloader.html#setup_paths"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.seismoloader.setup_paths" title="Link to this definition"></a></dt>
<dd><p>Initialize paths and database for seismic data management.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>settings</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="../../seed_vault.models.html#seed_vault.models.config.SeismoLoaderSettings" title="seed_vault.models.config.SeismoLoaderSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeismoLoaderSettings</span></code></a></span>) – Configuration settings containing paths and database information.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Updated settings with validated paths</p></li>
<li><p>Initialized DatabaseManager instance</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple containing</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If SDS path is not set in settings.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">settings</span> <span class="o">=</span> <span class="n">SeismoLoaderSettings</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">settings</span><span class="o">.</span><span class="n">sds_path</span> <span class="o">=</span> <span class="s2">&quot;/data/seismic&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">settings</span><span class="p">,</span> <span class="n">db_manager</span> <span class="o">=</span> <span class="n">setup_paths</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-seed_vault.service.stations">
<span id="seed-vault-service-stations-module"></span><h2>seed_vault.service.stations module<a class="headerlink" href="#module-seed_vault.service.stations" title="Link to this heading"></a></h2>
<p>The stations service should get the stations based on a selection (filter) settings.
UI should generate the selection and pass it here. We need a single function
here that gets the selection and runs Rob’s script.</p>
<p>We should also be able to support multi-select areas.</p>
<p>&#64;TODO: For now, dummy scripts are used. &#64;Yunlong to fix.</p>
<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.stations.get_station_data">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.stations.</span></span><span class="sig-name descname"><span class="pre">get_station_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">settings</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/stations.html#get_station_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.stations.get_station_data" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.stations.remove_duplicate_inventories">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.stations.</span></span><span class="sig-name descname"><span class="pre">remove_duplicate_inventories</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inventories</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/stations.html#remove_duplicate_inventories"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.stations.remove_duplicate_inventories" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.stations.station_response_to_df">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.stations.</span></span><span class="sig-name descname"><span class="pre">station_response_to_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inventory</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/stations.html#station_response_to_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.stations.station_response_to_df" title="Link to this definition"></a></dt>
<dd><p>Convert ObsPy Inventory data into a DataFrame with station information.</p>
</dd></dl>

</section>
<section id="module-seed_vault.service.utils">
<span id="seed-vault-service-utils-module"></span><h2>seed_vault.service.utils module<a class="headerlink" href="#module-seed_vault.service.utils" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.utils.check_client_services">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.utils.</span></span><span class="sig-name descname"><span class="pre">check_client_services</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">client_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/utils.html#check_client_services"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.utils.check_client_services" title="Link to this definition"></a></dt>
<dd><p>Check which services are available for a given client name.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.utils.convert_to_datetime">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.utils.</span></span><span class="sig-name descname"><span class="pre">convert_to_datetime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/utils.html#convert_to_datetime"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.utils.convert_to_datetime" title="Link to this definition"></a></dt>
<dd><p>Convert a string or other value to a date and time object, handling different formats.</p>
<p>If only a date is provided, it defaults to 00:00:00 time.</p>
<p>note that this returns a tuple of (date, time)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.utils.filter_catalog_by_geo_constraints">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.utils.</span></span><span class="sig-name descname"><span class="pre">filter_catalog_by_geo_constraints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">catalog</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraints</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/utils.html#filter_catalog_by_geo_constraints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.utils.filter_catalog_by_geo_constraints" title="Link to this definition"></a></dt>
<dd><p>Filter an ObsPy event catalog to include events within ANY of original search constraints.
This should be done to clean up any superfluous events that our reducted get_event calls
may have introduced.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Catalog</span></code></span></p>
</dd>
</dl>
<section id="id1">
<h3>Parameters:<a class="headerlink" href="#id1" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>catalog<span class="classifier">obspy.core.event.Catalog</span></dt><dd><p>The input event catalog to filter</p>
</dd>
</dl>
<p>constraints: settings.event.geo_constraint (whatever object type this is TODO)</p>
</section>
<section id="id2">
<h3>Returns:<a class="headerlink" href="#id2" title="Link to this heading"></a></h3>
<p>:
obspy.core.event.Catalog</p>
<blockquote>
<div><p>A new catalog containing events within any of the specified circles</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.utils.filter_inventory_by_geo_constraints">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.utils.</span></span><span class="sig-name descname"><span class="pre">filter_inventory_by_geo_constraints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inventory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraints</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/utils.html#filter_inventory_by_geo_constraints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.utils.filter_inventory_by_geo_constraints" title="Link to this definition"></a></dt>
<dd><p>Filter an ObsPy inventory to include stations within ANY of the original search constraints.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Inventory</span></code></span></p>
</dd>
</dl>
<section id="id3">
<h3>Parameters:<a class="headerlink" href="#id3" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>inventory<span class="classifier">obspy.Inventory</span></dt><dd><p>The input inventory to filter</p>
</dd>
<dt>constraints: settings.event.geo_constraint</dt><dd><p>List of geographical constraints</p>
</dd>
</dl>
</section>
<section id="id4">
<h3>Returns:<a class="headerlink" href="#id4" title="Link to this heading"></a></h3>
<p>:
obspy.Inventory</p>
<blockquote>
<div><p>A new inventory containing only stations within any of the specified constraints</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.utils.format_error">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.utils.</span></span><span class="sig-name descname"><span class="pre">format_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">station</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/utils.html#format_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.utils.format_error" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.utils.get_sds_filenames">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.utils.</span></span><span class="sig-name descname"><span class="pre">get_sds_filenames</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sds_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/utils.html#get_sds_filenames"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.utils.get_sds_filenames" title="Link to this definition"></a></dt>
<dd><p>Generate SDS (SeisComP Data Structure) format filenames for a time range.</p>
<p>Creates a list of daily SDS format filenames for given network, station,
location, and channel codes over a specified time period.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – Network code.</p></li>
<li><p><strong>s</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – Station code.</p></li>
<li><p><strong>l</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – Location code.</p></li>
<li><p><strong>c</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – Channel code.</p></li>
<li><p><strong>time_start</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">UTCDateTime</span></code></span>) – Start time for data requests.</p></li>
<li><p><strong>time_end</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">UTCDateTime</span></code></span>) – End time for data requests.</p></li>
<li><p><strong>sds_path</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – Root path of the SDS archive.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>/sds_path/YEAR/NETWORK/STATION/CHANNEL.D/NET.STA.LOC.CHA.D.YEAR.DOY</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of SDS format filepaths in the form</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">paths</span> <span class="o">=</span> <span class="n">get_sds_filenames</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s2">&quot;IU&quot;</span><span class="p">,</span> <span class="s2">&quot;ANMO&quot;</span><span class="p">,</span> <span class="s2">&quot;00&quot;</span><span class="p">,</span> <span class="s2">&quot;BHZ&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">UTCDateTime</span><span class="p">(</span><span class="s2">&quot;2020-01-01&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">UTCDateTime</span><span class="p">(</span><span class="s2">&quot;2020-01-03&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s2">&quot;/data/seismic&quot;</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.utils.get_time_interval">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.utils.</span></span><span class="sig-name descname"><span class="pre">get_time_interval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interval_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amount</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/utils.html#get_time_interval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.utils.get_time_interval" title="Link to this definition"></a></dt>
<dd><p>Get the current date-time and the date-time <cite>amount</cite> intervals earlier.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>interval_type</strong> (<em>str</em>) – One of [‘hour’, ‘day’, ‘week’, ‘month’]</p></li>
<li><p><strong>amount</strong> (<em>int</em>) – Number of intervals to go back (default is 1)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(current_datetime, past_datetime)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.utils.is_in_enum">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.utils.</span></span><span class="sig-name descname"><span class="pre">is_in_enum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enum_class</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/utils.html#is_in_enum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.utils.is_in_enum" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.utils.parse_inv">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.utils.</span></span><span class="sig-name descname"><span class="pre">parse_inv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/utils.html#parse_inv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.utils.parse_inv" title="Link to this definition"></a></dt>
<dd><p>Return 4 lists (net, sta, loc, cha) detailing the contents of an ObsPy inventory file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inv</strong> (<em>Inventory</em>) – ObsPy Inventory object</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Four lists containing all network, station, location, and channel codes</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.utils.remove_duplicate_events">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.utils.</span></span><span class="sig-name descname"><span class="pre">remove_duplicate_events</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">catalog</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/utils.html#remove_duplicate_events"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.utils.remove_duplicate_events" title="Link to this definition"></a></dt>
<dd><p>Remove duplicate events from an ObsPy Catalog based on resource IDs.</p>
<p>Takes a catalog of earthquake events and returns a new catalog containing only
unique events, where uniqueness is determined by the event’s resource_id.
The first occurrence of each resource_id is kept.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>catalog</strong> (<em>obspy.core.event.Catalog</em>) – Input catalog containing earthquake events</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>New catalog containing only unique events</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>obspy.core.event.Catalog</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">obspy</span><span class="w"> </span><span class="kn">import</span> <span class="n">read_events</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cat</span> <span class="o">=</span> <span class="n">read_events</span><span class="p">(</span><span class="s1">&#39;events.xml&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unique_cat</span> <span class="o">=</span> <span class="n">remove_duplicate_events</span><span class="p">(</span><span class="n">cat</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Removed </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">cat</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">unique_cat</span><span class="p">)</span><span class="si">}</span><span class="s2"> duplicate events&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.utils.shift_time">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.utils.</span></span><span class="sig-name descname"><span class="pre">shift_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reftime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amount</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/utils.html#shift_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.utils.shift_time" title="Link to this definition"></a></dt>
<dd><p>Shift time <cite>amount</cite> intervals relative to reftime
:type reftime: 
:param reftime: Reference time
:type reftime: datetime
:type interval_type: <span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>
:param interval_type: One of [‘hour’, ‘day’, ‘week’, ‘month’, ‘year’]
:type interval_type: str
:type amount: <span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span>
:param amount: Number of intervals to shift (positive = forward, negative = backward)
:type amount: int</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The new datetime after the shift, capped at current time if shifting forward</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>shifted_datetime</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.utils.to_timestamp">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.utils.</span></span><span class="sig-name descname"><span class="pre">to_timestamp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_obj</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/utils.html#to_timestamp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.utils.to_timestamp" title="Link to this definition"></a></dt>
<dd><p>Convert various time objects to Unix timestamp.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>time_obj</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">datetime</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">UTCDateTime</span></code>]</span>) – Time object to convert. Can be one of:
- int/float: Already a timestamp
- datetime: Python datetime object
- UTCDateTime: ObsPy UTCDateTime object</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Unix timestamp (seconds since epoch).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the input time object type is not supported.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ts</span> <span class="o">=</span> <span class="n">to_timestamp</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ts</span> <span class="o">=</span> <span class="n">to_timestamp</span><span class="p">(</span><span class="n">UTCDateTime</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ts</span> <span class="o">=</span> <span class="n">to_timestamp</span><span class="p">(</span><span class="mf">1234567890.0</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-seed_vault.service.waveform">
<span id="seed-vault-service-waveform-module"></span><h2>seed_vault.service.waveform module<a class="headerlink" href="#module-seed_vault.service.waveform" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.waveform.check_is_archived">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.waveform.</span></span><span class="sig-name descname"><span class="pre">check_is_archived</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cursor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/waveform.html#check_is_archived"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.waveform.check_is_archived" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.waveform.get_local_waveform">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.waveform.</span></span><span class="sig-name descname"><span class="pre">get_local_waveform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">settings</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/waveform.html#get_local_waveform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.waveform.get_local_waveform" title="Link to this definition"></a></dt>
<dd><p>Get waveform data from a local client, handling comma-separated values for network,
station, location, and channel fields. Unlike remote requests, local SDS does not handle such things.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>request</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]</span>) – Tuple containing (network, station, location, channel, starttime, endtime)</p></li>
<li><p><strong>settings</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="../../seed_vault.models.html#seed_vault.models.config.SeismoLoaderSettings" title="seed_vault.models.config.SeismoLoaderSettings"><code class="xref py py-class docutils literal notranslate"><span class="pre">SeismoLoaderSettings</span></code></a></span>) – Settings object containing SDS path</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Stream object containing requested waveform data, or None if no data found</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.waveform.get_local_waveform_OLD">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.waveform.</span></span><span class="sig-name descname"><span class="pre">get_local_waveform_OLD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">settings</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/waveform.html#get_local_waveform_OLD"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.waveform.get_local_waveform_OLD" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seed_vault.service.waveform.stream_to_dataframe">
<span class="sig-prename descclassname"><span class="pre">seed_vault.service.waveform.</span></span><span class="sig-name descname"><span class="pre">stream_to_dataframe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stream</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/seed_vault/service/waveform.html#stream_to_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#seed_vault.service.waveform.stream_to_dataframe" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-seed_vault.service">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-seed_vault.service" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, CSIRO.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>